!function(t){var i={};function e(s){if(i[s])return i[s].exports;var l=i[s]={i:s,l:!1,exports:{}};return t[s].call(l.exports,l,l.exports,e),l.l=!0,l.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";e.r(i);class s{constructor(t){this.path=[],this.size_limit=t}pushPoint(t){this.path.push(t.x,t.y),this.path.length>this.size_limit&&this.path.shift()}draw(t){if(this.path.length<1)return;t.beginPath();let i=t=>"rgb(255, 255, "+t+")";t.strokeStyle=i(255);let e=this.path[0];t.moveTo(e.x,e.y);let s=0,l=void 0;this.path.forEach(e=>{0==s?(l=e,s++):(t.moveTo(l.x,l.y),t.lineTo(e.x,e.y),t.strokeStyle=i(255*(1-s/this.size_limit)),t.stroke(),l=e,s++)})}}const l=2e3,a=1e3,h=255/l*2;let o=1;class n{constructor(t,i,e){this.id=o++,this.mass=t,this.x=i,this.y=e,this.velocity={x:0,y:0},this.acceleration={x:0,y:0},this.radius=10+3*Math.log(t),this.isColliding=!1,this.time=0,this.path_tracker=new s(30)}draw(t,i,e,s){let o=this.radius*s,n=(this.x-i.x)*s+800,c=(this.y-i.y)*s+450;if(o>.5){if(this.time<l){let t=255,i=0;this.time<a?t=Math.floor(h*this.time):this.time>=a&&(i=Math.floor(h*(this.time-a)));let s="rgb(255, "+t+", "+i+")";e.fillStyle=s}else e.fillStyle="white";e.beginPath(),e.arc(n,c,o,0,2*Math.PI),e.fill()}else e.fillStyle="white",e.fillRect(n,c,1,1);this.path_tracker.draw(e)}}class c{constructor(t){this.G=t}exertGravityOnBall(t,i,e){let s={x:0,y:0};i.particles.forEach(t=>{if(t.id!=e.id){let l=t.x-e.x,a=t.y-e.y,h=l*l+a*a,o=this.G*t.mass/h;if(o>.1){let n=Math.sqrt(h);if(n<=e.radius+t.radius)i.collisions.push([e,t]),e.isColliding=!0,t.isColliding=!0;else{let t={x:l/n,y:a/n};s.x+=o*t.x,s.y+=o*t.y}}}}),e.acceleration.x+=s.x,e.acceleration.y+=s.y,e.velocity.x+=s.x*t.seconds,e.velocity.y+=s.y*t.seconds,e.x+=e.velocity.x*t.seconds,e.y+=e.velocity.y*t.seconds,e.path_tracker.pushPoint({x:e.x,y:e.y})}}class r{constructor(t){this.particles=[],this.collisions=[],this.gravity=t}addBallWithVelocity(t,i,e,s,l){let a=new n(t,i,e);a.velocity={x:s,y:l},this.addParticle(a)}addParticle(t){this.particles.push(t)}particles(){return particles}handleCollisions(){this.collisions.forEach(t=>{let i=t[0],e=t[1],s=this.particles.indexOf(i);s>-1&&this.particles.splice(s,1);let l=this.particles.indexOf(e);l>-1&&this.particles.splice(l,1);let a=i.mass+e.mass,h=(i.x*i.mass+e.x*e.mass)/a,o=(i.y*i.mass+e.y*e.mass)/a,c=(i.velocity.x*i.mass+e.velocity.x*e.mass)/a,r=(i.velocity.y*i.mass+e.velocity.y*e.mass)/a,d=new n(a,h,o);d.velocity={x:c,y:r},this.particles.push(d)}),this.collisions=[]}update(t){this.handleCollisions(),this.particles.forEach(i=>{i.time+=t.ms,i.isColliding||this.gravity.exertGravityOnBall(t,this,i)})}}let d=new class{constructor(t,i,e){this.ctx=t,this.width=i,this.height=e,this.ctx.canvas.width=i,this.ctx.canvas.height=e;let s=new c(1e4);this.universe=new r(s),this.wheel=0,this.zoom=1,this.origin={x:0,y:0},this.setInput(),this.isPaused=!1}togglePause(){this.isPaused=!this.isPaused}setInput(){this.down=!1,this.ctx.canvas.addEventListener("wheel",t=>{let i=t.wheelDelta/2e3;this.wheel+=i,this.zoom=Math.exp(this.wheel),console.log("zoom: "+this.zoom)}),this.ctx.canvas.addEventListener("mousedown",t=>{this.down=!0}),this.ctx.canvas.addEventListener("mousemove",t=>{this.down&&(this.origin.x-=t.movementX/this.zoom,this.origin.y-=t.movementY/this.zoom)}),this.ctx.canvas.addEventListener("mouseup",t=>{this.down=!1})}init(){var t;(t=this.universe).addBallWithVelocity(1e3,0,0,0,0),t.addBallWithVelocity(1,-400,0,0,50),t.addBallWithVelocity(1,700,0,0,-50),t.addBallWithVelocity(1,0,400,150,0),t.addBallWithVelocity(1,800,800,60,-60)}update(t){this.isPaused||this.universe.update(t)}clear(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.width,this.height)}draw(t){let i=this.origin,e=this.ctx,s=this.zoom;this.universe.particles.forEach(l=>{l.draw(t,i,e,s)})}}(document.getElementById("canvas").getContext("2d"),1600,900);const u={seconds:1/60,ms:1e3/60};d.init(),setInterval(function(){d.update(u),d.clear(),d.draw(u)},1/60*1e3);document.getElementById("arb").onclick=(()=>{let t=5*Math.random()+.5,i=2*Math.random()*Math.PI,e=600*Math.random()+200,s=e*Math.cos(i),l=e*Math.sin(i),a=800*Math.random()-400,h=800*Math.random()-400;d.universe.addBallWithVelocity(t,s,l,a,h)});let y=document.getElementById("pause");y.onclick=(()=>{d.togglePause(),d.isPaused?y.innerHTML="Continue":y.innerHTML="Pause"})}]);